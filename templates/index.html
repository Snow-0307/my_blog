<!-- å£°æ˜è¿™ä¸ªæ¨¡æ¿ç»§æ‰¿è‡ª base.html -->
{% extends "base.html" %}

<!-- å®šä¹‰è¦å¡«å……åˆ° base.html ä¸­ title å—çš„å†…å®¹ -->
{% block title %}æˆ‘çš„æŠ€æœ¯åšå®¢{% endblock %}

{% if current_user %}
    <p>æ¬¢è¿å›æ¥ï¼Œ<strong>{{ current_user.username }}</strong>ï¼</p>
{% else %}
    <p>æ‚¨å°šæœªç™»å½•ã€‚<a href="{{ url_for('login') }}">è¯·ç™»å½•</a>æˆ–<a href="{{ url_for('register') }}">æ³¨å†Œ</a>ã€‚</p>
{% endif %}

<!-- å®šä¹‰è¦å¡«å……åˆ° content å—çš„å†…å®¹ -->
{% block content %}
    <h1>æˆ‘çš„åšå®¢æ–‡ç« </h1>

    <!-- å®‰å…¨æ£€æŸ¥ï¼šå¦‚æœpostsåˆ—è¡¨ä¸ºç©ºï¼Œæ˜¾ç¤ºå‹å¥½æç¤º -->
    {% if posts %}
        <p>å…± {{ post_count }} ç¯‡æ–‡ç« ï¼š</p>
        <!-- å¼€å§‹å¾ªç¯ï¼šå¯¹postsåˆ—è¡¨ä¸­çš„æ¯ä¸€ç¯‡æ–‡ç« (post)è¿›è¡Œæ¸²æŸ“ -->
        {% for post in posts %}
            <article class="card shadow-sm mb-4">
                <div class="card-body">
                    <!-- æ˜¾ç¤ºæ–‡ç« æ ‡é¢˜ (post.title æ¥è‡ªæ•°æ®åº“) -->
                    <h2 class="card-title">{{ post.title }}</h2>
                    <!-- æ˜¾ç¤ºæ–‡ç« å‘å¸ƒæ—¥æœŸï¼Œå¹¶æ ¼å¼åŒ–ä¸ºâ€˜å¹´-æœˆ-æ—¥â€™ -->
                    <small>
                        ä½œè€…:{{ post.author.username if post.author else 'æœªçŸ¥ç”¨æˆ·' }} |
                        å‘å¸ƒæ—¥æœŸï¼š{{ post.created_at.strftime('%Y-%m-%d') }}
                    </small>
                    <!-- æ˜¾ç¤ºæ–‡ç« å†…å®¹ (post.content æ¥è‡ªæ•°æ®åº“) -->
                    <p>{{ post.content }}</p>
                    <!-- æœªæ¥å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ â€˜é˜…è¯»æ›´å¤šâ€™æˆ–â€˜ç¼–è¾‘â€™çš„é“¾æ¥ -->
                    {% if current_user and post.author and current_user.id == post.author.id %}
                    <hr>
                    <div style="margin-top: 10px;">
                        <!-- ç¼–è¾‘æŒ‰é’®ï¼šè·³è½¬åˆ°ç¼–è¾‘é¡µé¢ -->
                        <a href="{{ url_for('edit_post', post_id=post.id) }}" style="margin-right: 15px;">âœï¸ ç¼–è¾‘</a>

                        <!-- åˆ é™¤æŒ‰é’®ï¼šä¸€ä¸ªå°è¡¨å•ï¼Œç‚¹å‡»åç›´æ¥æäº¤åˆ°åˆ é™¤è·¯ç”± -->
                        <form action="{{ url_for('delete_post', post_id=post.id) }}" method="POST" style="display: inline;"
                            onsubmit="return confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ–‡ç« å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚');">
                            <button type="submit" style="background: none; border: none; color: red; cursor: pointer; padding: 0;">ğŸ—‘ï¸ åˆ é™¤</button>
                        </form>
                    </div>
                    {% endif %}
                </div>
            </article>
        {% endfor %}
    {% else %}
        <!-- å¦‚æœæ•°æ®åº“é‡Œä¸€ç¯‡æ–‡ç« éƒ½æ²¡æœ‰ï¼Œæ˜¾ç¤ºè¿™ä¸ª -->
        <div class="alert">
            <p>è¿˜æ²¡æœ‰ä»»ä½•æ–‡ç« ã€‚</p>
            <p><a href="{{ url_for('create_post') }}">ç‚¹å‡»è¿™é‡Œæ’°å†™ä½ çš„ç¬¬ä¸€ç¯‡åšå®¢</a></p>
        </div>
    {% endif %}
{% endblock %}