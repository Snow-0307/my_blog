{% extends "base.html" %}

{% block title %}å¤©æ°”æ•°æ®é¢æ¿ - æˆ‘çš„åšå®¢{% endblock %}

{% block content %}
<div class="weather-dashboard">
    <h1>ğŸŒ¤ï¸ å¤©æ°”æ•°æ®é¢æ¿</h1>

    <!-- æ“ä½œæŒ‰é’® -->
    <div style="margin: 20px 0; display: flex; gap: 15px;">
        <a href="{{ url_for('weather_dashboard') }}" class="btn btn-info">åˆ·æ–°é¡µé¢</a>
        <form action="{{ url_for('fetch_weather_now') }}" method="POST" style="display: inline;">
            <button type="submit" class="btn btn-primary">ç«‹å³è·å–æœ€æ–°å¤©æ°”</button>
        </form>
    </div>

    <!-- æœ€æ–°å¤©æ°”å¡ç‰‡ -->
    {% if latest_weather %}
    <div class="weather-card current-weather">
        <h2>å½“å‰å¤©æ°”ï¼ˆ{{ latest_weather.city }}ï¼‰</h2>
        <div style="display: flex; align-items: center; gap: 30px;">
            <div style="font-size: 48px; font-weight: bold;">
                {{ latest_weather.temperature|round(1) }}Â°C
            </div>
            <div>
                <p><strong>å¤©æ°”çŠ¶å†µï¼š</strong> {{ latest_weather.condition }}</p>
                <p><strong>æ¹¿åº¦ï¼š</strong> {{ latest_weather.humidity }}%</p>
                <p><strong>é£é€Ÿï¼š</strong> {{ latest_weather.wind_speed|round(1) }} km/h</p>
                <p><strong>æ›´æ–°æ—¶é—´ï¼š</strong> {{ latest_weather.recorded_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-warning">
        <p>æš‚æ— å¤©æ°”æ•°æ®ã€‚è¯·ç‚¹å‡»â€œç«‹å³è·å–æœ€æ–°å¤©æ°”â€æŒ‰é’®å¼€å§‹æ”¶é›†æ•°æ®ã€‚</p>
    </div>
    {% endif %}

    <!-- å¤©æ°”å†å²è®°å½• -->
    {% if weather_history %}
    <div class="weather-history" style="margin-top: 40px;">
        <h3>ğŸ“Š å†å²è®°å½•ï¼ˆæœ€è¿‘10æ¬¡ï¼‰</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>æ—¶é—´</th>
                    <th>æ¸©åº¦ (Â°C)</th>
                    <th>å¤©æ°”çŠ¶å†µ</th>
                    <th>æ¹¿åº¦</th>
                    <th>é£é€Ÿ</th>
                </tr>
            </thead>
            <tbody>
                {% for record in weather_history %}
                <tr>
                    <td>{{ record.recorded_at.strftime('%m-%d %H:%M') }}</td>
                    <td>{{ record.temperature|round(1) }}</td>
                    <td>{{ record.condition }}</td>
                    <td>{{ record.humidity }}%</td>
                    <td>{{ record.wind_speed|round(1) }} km/h</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
</div>

<style>
.weather-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 15px;
    margin: 20px 0;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    font-weight: bold;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-info {
    background-color: #17a2b8;
    color: white;
}

.table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.table th, .table td {
    border: 1px solid #ddd;
    padding: 12px;
    text-align: left;
}

.table th {
    background-color: #f8f9fa;
    font-weight: bold;
}

.alert {
    padding: 15px;
    border-radius: 5px;
    margin: 20px 0;
}

.alert-warning {
    background-color: #fff3cd;
    border: 1px solid #ffeaa7;
    color: #856404;
}
</style>
{% endblock %}